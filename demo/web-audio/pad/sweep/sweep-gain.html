<body>
    <label for="attack">Attack</label>
    <input name="attack" id="attack" type="range" min="0" max="1" value="0.2" step="0.1" />
    
    <label for="release">Release</label>
    <input name="release" id="release" type="range" min="0" max="1" value="0.5" step="0.1" />
</body>

<script src="wavetable.js"></script>
<script>
    audioContext = new window.AudioContext()

    periodicWave = audioContext.createPeriodicWave(wavetable.real, wavetable.imag)

    sweepLength = 2
    function playSweep() {
        oscillatorNode = audioContext.createOscillator()
        oscillatorNode.setPeriodicWave(periodicWave)
        oscillatorNode.frequency.value = 440

        gainNode = audioContext.createGain()
        gainNode.gain.cancelScheduledValues(audioContext.currentTime)
        gainNode.gain.setValueAtTime(0, audioContext.currentTime)
        // set our attack
        gainNode.gain.linearRampToValueAtTime(1, audioContext.currentTime + attackTime)
        // set our release
        gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + sweepLength - releaseTime)

        oscillatorNode.connect(gainNode).connect(audioContext.destination)
        oscillatorNode.start()
        oscillatorNode.stop(audioContext.currentTime + sweepLength)
    }

    attackTime = 0.2
    attackControl = document.querySelector('#attack')
    attackControl.addEventListener('input', function () {
        attackTime = Number(this.value)
    }, false)

    releaseTime = 0.5
    releaseControl = document.querySelector('#release')
    releaseControl.addEventListener('input', function () {
        releaseTime = Number(this.value)
    }, false)

    playSweep()
</script>